<!--
Faire une page avec un champs select qui permet de choisir un prénom
mettre en place une requête ajax qui récupère le prénom choisi pour la passer dans les paramètres
et afficher la réponse dans notre page 
-->

<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <style>
            *{
                font-family: sans-serif;
            }
            
            form{
                width: 50%;
                margin : 0 auto;
            }

            select, input{
                padding: 5px;
                width: 100%;
            }
        </style>
    </head>
    <body>
        <form method="post" action="">
            <label for="prenom">Choisissez un prenom</label>
            <select id="choix"  onchange="ajaxGetPrenom()">
                <option value="Laura">Laura</option>
                <option value="Daniel">Daniel</option>
                <option value="Julien">Julien</option>
                <option value="Fabrice">Fabrice</option>
                <option value="Elodie">Elodie</option>
                <option value="Stephanie">Stephanie</option>
            </select>
            <br>
            <br>
            <input type="submit" value="Valider">
        </form>
        <div id="resultat"></div>

        <script>
            function ajaxGetPrenom(){
                //alert( 'ok' ); je vérifie que je rentre bien dans la fonction 
               
                var choix = document.getElementById( 'choix' );
                choix = choix.value;
                //alert( 'choix' ); // je vérifie que je récupère bien la valeur

                var file = "ajax.php"; //notre page cible

                r = new XMLHttpRequest();
                
                var parametres = "prenom=" + choix;

                r.open('POST', file, true); // préparation
                r.setRequestHeader( 'Content-type', 'application/x-www-form-urlencoded' );
                // La methode setRequestHeader() définit la valeur d'un header http
                // Vous devrez appeler cette méthode entre la méthode open() et send()

                r.onreadystatechange = function(){
                    if(r.readyState == 4 && r.status == 200){
                        console.log(r.responseText);
                        var obj = JSON.parse(r.responseText);
                        // La méthode parse de l'objet JSON permet d'évaluer la réponse et d'en faire un objet.
                        document.getElementById( 'resultat' ).innerHTML = obj.resultat;
                    }
                }
                r.send(parametres); // envoie
                
                
            }
        </script>
    </body>
</html>